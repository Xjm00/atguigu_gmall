package com.atguigu.gmall.order.service.impl;import com.alibaba.dubbo.config.annotation.Service;import com.alibaba.fastjson.JSON;import com.atguigu.gmall.bean.OmsOrderItem;import com.atguigu.gmall.order.mapper.OmsOrderItemMapper;import com.atguigu.gmall.service.OmsOrderItemService;import com.atguigu.gmall.secskill.util.RedisUtil;import org.springframework.beans.factory.annotation.Autowired;import redis.clients.jedis.Jedis;import java.util.ArrayList;import java.util.HashMap;import java.util.List;/** * @ClassName OmsOrderItemServiceImpl * @Author 19680 * @Date 2020/2/13 11:43 * @Version 1.0 * @Description TODO **/@Servicepublic class OmsOrderItemServiceImpl implements OmsOrderItemService {    @Autowired    OmsOrderItemMapper omsOrderItemMapper;    @Autowired    RedisUtil redisUtil;    @Override    public void savaOrderItem(ArrayList<OmsOrderItem> omsOrderItems) {        if (omsOrderItems != null && omsOrderItems.size() > 0){            for (OmsOrderItem omsOrderItem : omsOrderItems) {                omsOrderItemMapper.insert(omsOrderItem);            }        }    }    @Override    public void flushallOrderItem(ArrayList<OmsOrderItem> omsOrderItems) {        if (omsOrderItems != null && omsOrderItems.size() > 0){            Jedis jedis = redisUtil.getJedis();            HashMap<String, String> map = new HashMap<>();            String key = "orderId:" + omsOrderItems.get(0).getOrderId() + ":orderSn:" + omsOrderItems.get(0).getOrderSn();            for (OmsOrderItem omsOrderItem : omsOrderItems) {                map.put(key, JSON.toJSONString(omsOrderItem));            }            jedis.hmset(key,map);            try {                jedis.close();            } catch (Exception e) {                e.printStackTrace();            }        }    }    @Override    public List<OmsOrderItem> getOrderItemsByOrderSn(String orderId) {        OmsOrderItem omsOrderItem = new OmsOrderItem();        omsOrderItem.setOrderSn(orderId);        return omsOrderItemMapper.select(omsOrderItem);    }}